-- Carrega a biblioteca do Fluent GUI
local Fluent = loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()

-- Servi√ßos
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local workspace = game:GetService("Workspace")
local LocalPlayer = Players.LocalPlayer

-- Cria a janela principal do GUI
local Window = Fluent:CreateWindow({
    Title = "Interface Simples",
    SubTitle = "Com dois bot√µes",
    TabWidth = 140,
    Size = UDim2.fromOffset(400, 400),
    Theme = "Darker",
    MinimizeKey = Enum.KeyCode.LeftControl
})

-- Aba principal
local MainTab = Window:AddTab({
    Title = "Op√ß√µes",
    Icon = "settings"
})

-- =======================
-- CONFIG TELEPORT + BP TWEEN + ALAVANCA
-- =======================
local finalCoord = Vector3.new(-5273.6865234375, -5289.41943359375, 12380.43359375)
local CelestialRemote = ReplicatedStorage:WaitForChild("Modules")
    :WaitForChild("Net")
    :WaitForChild("RF/CelestialDomainTransportation")
local running = false

local function activateCelestialRemote()
    pcall(function()
        CelestialRemote:InvokeServer("InitiateTeleportToTemple")
        warn("‚ú® Pedido de teleport para Celestial Dimension enviado via Remote!")
    end)
end

local function moveToPositionBP(targetPos, speed, callback)
    local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    local hrp = char:WaitForChild("HumanoidRootPart")

    local bp = hrp:FindFirstChild("NightMysticBP")
    if bp then bp:Destroy() end

    bp = Instance.new("BodyPosition")
    bp.Name = "NightMysticBP"
    bp.MaxForce = Vector3.new(1e5,1e5,1e5)
    bp.P = 1e4
    bp.D = 100
    bp.Position = hrp.Position
    bp.Parent = hrp

    local conn
    conn = RunService.Stepped:Connect(function(_, dt)
        for _, part in ipairs(char:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
            end
        end

        local direction = targetPos - hrp.Position
        local distance = direction.Magnitude

        if distance < 0.5 then
            hrp.CFrame = CFrame.new(targetPos)
            bp:Destroy()
            conn:Disconnect()
            if callback then callback() end
            return
        end

        local moveStep = math.min(speed * dt, distance)
        bp.Position = hrp.Position + direction.Unit * moveStep
    end)
end

local function pullLeverRepeatedly()
    local leverPrompt = workspace.Map["Celestial Domain"].Elevator.Lever.Base:FindFirstChild("ProximityPrompt")
    if leverPrompt then
        while running do
            fireproximityprompt(leverPrompt)
            task.wait(1)
        end
        warn("‚èπÔ∏è Parou de puxar a alavanca")
    else
        warn("‚ö†Ô∏è N√£o achei o ProximityPrompt da alavanca!")
    end
end

local function afterTeleport()
    repeat task.wait(0.5) until workspace:FindFirstChild("Map") and workspace.Map:FindFirstChild("Celestial Domain")
    warn("‚úÖ Entrou na Celestial Dimension!")

    moveToPositionBP(finalCoord, 325, function()
        warn("üöÄ Chegou na coordenada final dentro da Celestial!")
        task.spawn(pullLeverRepeatedly)
    end)
end

-- =======================
-- CONFIG SEGUIR NPC
-- =======================
local npcName = "Rip Commander"
local npcHRP = workspace:WaitForChild(npcName):WaitForChild("HumanoidRootPart")
local followOffsetY = 3
local followRunning = false

local function followNPC()
    local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    local hrp = char:WaitForChild("HumanoidRootPart")

    local conn
    conn = RunService.RenderStepped:Connect(function()
        if not followRunning then
            conn:Disconnect()
            return
        end

        for _, part in ipairs(char:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
            end
        end

        hrp.CFrame = CFrame.new(
            npcHRP.Position.X,
            npcHRP.Position.Y + followOffsetY,
            npcHRP.Position.Z
        )
    end)
end

-- =======================
-- TOGGLE 1: Teleport + BP Tween + Alavanca
-- =======================
local toggle1Enabled = false
MainTab:AddToggle("Toggle1", {
    Title = "Teleport + BP Tween + Alavanca",
    Default = toggle1Enabled,
    Callback = function(Value)
        toggle1Enabled = Value
        running = Value
        if toggle1Enabled then
            activateCelestialRemote()
            task.spawn(afterTeleport)
        else
            warn("‚èπÔ∏è Teleport desativado")
        end
    end
})

-- =======================
-- TOGGLE 2: Seguir Rip Commander
-- =======================
local toggle2Enabled = false
MainTab:AddToggle("Toggle2", {
    Title = "Seguir Rip Commander",
    Default = toggle2Enabled,
    Callback = function(Value)
        toggle2Enabled = Value
        followRunning = Value
        if toggle2Enabled then
            followNPC()
            warn("üîπ Seguindo o Rip Commander...")
        else
            warn("‚èπÔ∏è Parou de seguir o Rip Commander")
        end
    end
})

-- Exibe a interface
Window:Show()
